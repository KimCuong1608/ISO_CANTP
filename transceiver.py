from can_tp import CAN_TP
from can_tp import DiagRx
import time
import can

# if __name__ == "__main__":

rx = DiagRx()

# Init Tx Node
bus = can.interface.Bus(interface='neovi', channel=1, bitrate=500000, receive_own_messages =  False)
tp = CAN_TP(bus, False, 0x08)
can.Notifier(bus, [tp])
tp.addObserver(rx)

# Data Test
data = [0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F]
id = 0xC0FF

while True:
    tp.sendData(data, id)
    time.sleep(5)